# 微内核

YiYiYa提供了微服务级别的支持。鸭的一个服务可以是一个程序，也可以是一个so，一个设备驱动，一个函数。可以开多个服务，负载均衡，也可以多个版本同时开。

内核是服务的调度中心了，以前都是管cpu的调度，不管应用调度，现在也管了。


## 实现原理

鸭是一个类似mq的机制，鸭从内存分配一块，然后需要调用的时候，往里面丢消息，另外，有mq接收端负责处理从内存中拿消息处理。区别和别的os方式是，别的os都是走ipc的，需要经过syscall 直接调对方的服务。而鸭内核则不需要，这样没有开销了，而且还可以多个服务订阅同一个消息，执行相应的动作。

在elf 加载时候自动注册函数，远程可以直接调本地函数，不需要应用特别去改代码，实现远程调用啥的方式，当然可以显示的调用。

![](image/2023-07-16-12-08-27.png)

>a服务调b服务，都要先走一下ipc过一下内核，回来也要走一下，换成鸭的架构，a调b，直接掉就结束了，回来也直接回来。


##  应用场景

比如平常桌面挂了，可以0秒切换到另外一个桌面程序，不影响正常使用。而且可以同时跑多种不同的桌面程序，想用哪个桌面就直接用。

复用linux驱动，以后的linux作为服务A跑着呢，掉驱动就可以直接应用来调用了。